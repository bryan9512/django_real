<!doctype html>
{% load staticfiles %}
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>IAM:</title>
    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/checkout/">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
        <!-- Bootstrap core CSS -->
    <link href="/docs/4.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/font.css' %}">
    <link rel="stylesheet" href="{% static 'css/sizing.css' %}">
    <link rel="stylesheet" href="{% static 'css/border.css' %}">

    <!-- Custom styles for this template -->
    <link href="form-validation.css" rel="stylesheet">



    <!-- script used for audio/video/gif recording -->
    <script src="https://www.webrtc-experiment.com/RecordRTC.js"></script>
    <script src="https://www.webrtc-experiment.com/DetectRTC.js"></script>
    <script src="https://www.webrtc-experiment.com/gif-recorder.js"></script>
    <script src="https://www.webrtc-experiment.com/getMediaElement.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
      <!--비디오 레코딩-->
  </head>

  <style>
      body{
        background-color:green;
  }
  </style>

  <body>
        <div class="container">
            <div class=" row justify-content-md-center">

                <div class="align-self-center" id="stts" style="display:inline-block;  background-color: rgba(255, 255, 255, .4); width:300px; height:300px; color: white; position:fix;  margin-top:200px;">
                    <textarea id="stt_textarea" rows="7">

                    </textarea>
                    <button id="start">Start</button>
                    <button id="stop">Stop</button>
                    <button id="get">Get</button>
                    <button id="save" disabled>Save</button>
                    <button id="stop_saying">대답 끝내기</button>
                    <div id="videos-container"></div>
                    <audio id="audio"></audio>

                </div>
             </div>
            <audio src="{{ questionszero }}" type="audio/wav" id="zero_point"></audio>
            <audio src="{{ questionsone }}" type="audio/wav" id="starting_point"></audio>
            <audio src="{{ questionstswo }}" type="audio/wav" id="second_point"></audio>
         </div>


<script>

        var audiozero= document.getElementById("zero_point");
        var audioone= document.getElementById("starting_point");
        var audiotwo= document.getElementById("second_point");

        setTimeout( function(){
            document.getElementById("zero_point").play();
        },3000);

        audiozero.onended = function(){

            setTimeout( function() {
            audioone.play();
            }, 1000);
            RecordStart();
        };

        audioone.onended =  function(){
            setTimeout( function() {
            audiotwo.play();
            }, 1000);
        };

        // 오디오 끝난 이후




        function captureUserMedia(mediaConstraints, successCallback, errorCallback) {
            navigator.mediaDevices.getUserMedia(mediaConstraints).then(successCallback).catch(errorCallback);
        }
        var videosContainer = document.getElementById('videos-container');
        var mRecordRTC = new MRecordRTC();
        mRecordRTC.mediaType = {
            audio: true, // or StereoAudioRecorder or MediaStreamRecorder (WebAssembly also supports audio-encoding however not implemented in WebAssemblyRecorder YET)
            video: true  // or WhammyRecorder      or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
        };
        if (DetectRTC.browser.name === 'Edge') {
            // Microsoft Edge currently supports only audio and gif recording
            mRecordRTC.mediaType = {
                audio: StereoAudioRecorder
            };
        }




        function RecordStart(){
          captureUserMedia({
              audio: true,
              video: true
          },
          //div 안에 비디오 객체 만들어놓는거임!
          function(stream) {
              var video = document.createElement('video');
              video.autoplay = true;
              video.srcObject = stream;
              var mediaElement = getMediaElement(video, {
                  buttons: [],
                  showOnMouseEnter: false,
                  enableTooltip: false,
                  onMuted: function() {
                      document.querySelector('#audio').muted = true;
                  },
                  onUnMuted: function() {
                      document.querySelector('#audio').muted = false;
                      document.querySelector('#audio').play();
                  }
              });
              videosContainer.appendChild(mediaElement);
              videosContainer.style.display = "none";
              mRecordRTC.addStream(stream);
              mRecordRTC.startRecording();
          }, function(error) {
              alert(JSON.stringify(error));
          });
        };

        function RecordEnd(){
          mRecordRTC.stopRecording(function(url, type) {
              document.querySelector(type).srcObject = null;
              document.querySelector(type).src = url;
              document.querySelector(type).play();
              // fixing firefox playback issue
              if (!!navigator.mozGetUserMedia) {
                      document.querySelector(type).onended = function() {
                      document.querySelector(type).srcObject = null;
                      document.querySelector(type).src = URL.createObjectURL(mRecordRTC.getBlob()[type]);
                      document.querySelector(type).play();
                  };
              }
              mRecordRTC.writeToDisk();
              save.disabled = false;
          });
        };



        // mRecordRTC.bufferSize = 16384;
        document.querySelector('#start').onclick = function() {
            this.disabled = true;
            captureUserMedia({
                audio: true,
                video: true
            },
						//div 안에 비디오 객체 만들어놓는거임!
						function(stream) {
                var video = document.createElement('video');
                video.autoplay = true;
                video.srcObject = stream;
                var mediaElement = getMediaElement(video, {
                    buttons: [],
                    showOnMouseEnter: false,
                    enableTooltip: false,
                    onMuted: function() {
                        document.querySelector('#audio').muted = true;
                    },
                    onUnMuted: function() {
                        document.querySelector('#audio').muted = false;
                        document.querySelector('#audio').play();
                    }
                });
                videosContainer.appendChild(mediaElement);
								videosContainer.style.display = "none";
                mRecordRTC.addStream(stream);
                mRecordRTC.startRecording();
            }, function(error) {
                alert(JSON.stringify(error));
            });
        };

        document.querySelector('#stop').onclick = function() {
            this.disabled = true;
            mRecordRTC.stopRecording(function(url, type) {
                document.querySelector(type).srcObject = null;
                document.querySelector(type).src = url;
                document.querySelector(type).play();
                // fixing firefox playback issue
                if (!!navigator.mozGetUserMedia) {
                        document.querySelector(type).onended = function() {
                        document.querySelector(type).srcObject = null;
                        document.querySelector(type).src = URL.createObjectURL(mRecordRTC.getBlob()[type]);
                        document.querySelector(type).play();
                    };
                }
                mRecordRTC.writeToDisk();
                save.disabled = false;
            });
        };
        document.getElementById('save').onclick = function() {
            this.disabled = true;
            mRecordRTC.save();
        };
        document.querySelector('#get').onclick = function() {
            this.disabled = true;
            !!navigator.webkitGetUserMedia && MRecordRTC.getFromDisk('all', function(dataURL, type) {
                if (!dataURL) return;
                if (type == 'audio') {
                    document.querySelector('#audio').src = dataURL;
                }
                if (type == 'video') {
                    var video = document.createElement('video');
                    video.src = dataURL;
                    var mediaElement = getMediaElement(video, {
                        buttons: ['mute-video'],
                        showOnMouseEnter: false,
                        enableTooltip: false,
                        onMuted: function() {
                            document.querySelector('#audio').muted = true;
                        },
                        onUnMuted: function() {
                            document.querySelector('#audio').muted = false;
                            document.querySelector('#audio').play();
                        }
                    });
                    videosContainer.appendChild(mediaElement);
                    document.querySelector('#audio').play();
                    mediaElement.media.play();
                }
                if (type == 'gif') {
                    var gifImage = document.createElement('img');
                    gifImage.src = dataURL;
                    videosContainer.appendChild(gifImage);
                }
            });
            !!navigator.mozGetUserMedia && MRecordRTC.getFromDisk('video', function(dataURL) {
                if (!dataURL) return;
                var video = document.createElement('video');
                video.src = dataURL;
                var mediaElement = getMediaElement(video, {
                    buttons: ['mute-video'],
                    showOnMouseEnter: false,
                    enableTooltip: false,
                    onMuted: function() {
                        mediaElement.muted = true;
                    },
                    onUnMuted: function() {
                        mediaElement.muted = false;
                        mediaElement.play();
                    }
                });
                videosContainer.appendChild(mediaElement);
                mediaElement.media.play();
            });
        };
        window.addEventListener('beforeunload', function() {
            document.querySelector('#start').disabled = false;
            document.querySelector('#stop').disabled = false;
            document.querySelector('#get').disabled = false;
        }, false);
        </script>

      <script>window.jQuery || document.write('<script src="/docs/4.3/assets/js/vendor/jquery-slim.min.js"><\/script>')</script><script src="/docs/4.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o" crossorigin="anonymous"></script>
        <script src="form-validation.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
      </body>
</html>
